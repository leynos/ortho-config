[CmdletBinding(PositionalBinding = $false)]
param()

function fixture {
  [CmdletBinding(PositionalBinding = $false)]
  param([Parameter(ValueFromRemainingArguments = $true)][string[]]$RemainingArgs)
  $exe = Join-Path $PSScriptRoot '..' 'bin' 'fixture.exe'
  $exe = (Resolve-Path $exe).ProviderPath
  & $exe @RemainingArgs
  $global:LASTEXITCODE = $LASTEXITCODE
}

Set-Alias -Name 'fixture-help' -Value 'fixture'

$sb = {
  param($wordToComplete, $commandAst, $cursorPosition)
  if ($wordToComplete) {
    [System.Management.Automation.CompletionResult]::new(
      $wordToComplete,
      $wordToComplete,
      'ParameterValue',
      $wordToComplete
    )
  }
}
$hasNative = (Get-Command Register-ArgumentCompleter).Parameters.ContainsKey('Native')
if ($hasNative) {
  Register-ArgumentCompleter -Native -CommandName 'fixture' -ScriptBlock $sb
} else {
  Register-ArgumentCompleter -CommandName 'fixture' -ScriptBlock $sb
}
